import{x as a,y as c,B as r,C as l,G as f,H as m,a8 as _,F as u,A as s,P as k,N as d,J as D,K as P,a0 as $,d as U,r as V,s as F,ay as M,k as R,j as x,w as A,ak as G,at as q,az as E,I,aa as O,au as H}from"./frappe-ui-C1kNCtW7.js";import{d as J,f as N,G as K,u as Q,P as W}from"./index-z00NSwZC.js";import{_ as X}from"./DateRange-CjW-ebz9.js";import{_ as Y}from"./CourseInstructors-DXvXgK2q.js";import{_ as Z}from"./UserAvatar-DAzeZQK4.js";const ee={class:"flex flex-col shadow hover:bg-gray-100 rounded-md p-4 h-full",style:{"min-height":"150px"}},te={class:"text-lg leading-5 font-semibold mb-2"},ae={key:0},se={key:1},le={class:"short-introduction text-sm text-gray-700"},re={key:2,class:"font-semibold mb-4"},oe={class:"flex flex-col space-y-2 mt-auto"},ce={class:"flex items-center text-sm text-gray-700"},ne={key:0,class:"flex items-center text-sm text-gray-700"},ie={key:3,class:"flex avatar-group overlap mt-4"},de={__name:"BatchCard",props:{batch:{type:Object,default:null}},setup(t){return(n,i)=>{var b;return a(),c("div",ee,[r("div",te,l(t.batch.title),1),t.batch.seat_count&&t.batch.seats_left>0?(a(),f(s(k),{key:0,theme:"green",class:"self-start mb-2"},{default:m(()=>[_(l(t.batch.seats_left)+" ",1),t.batch.seats_left>1?(a(),c("span",ae,l(n.__("Seats Left")),1)):t.batch.seats_left==1?(a(),c("span",se,l(n.__("Seat Left")),1)):u("",!0)]),_:1})):t.batch.seat_count&&t.batch.seats_left<=0?(a(),f(s(k),{key:1,theme:"red",class:"self-start mb-2"},{default:m(()=>[_(l(n.__("Sold Out")),1)]),_:1})):u("",!0),r("div",le,l(t.batch.description),1),t.batch.amount?(a(),c("div",re,l(t.batch.price),1)):u("",!0),r("div",oe,[d(X,{startDate:t.batch.start_date,endDate:t.batch.end_date,class:"text-sm text-gray-700"},null,8,["startDate","endDate"]),r("div",ce,[d(s(J),{class:"h-4 w-4 stroke-1.5 mr-2 text-gray-700"}),r("span",null,l(s(N)(t.batch.start_time))+" - "+l(s(N)(t.batch.end_time)),1)]),t.batch.timezone?(a(),c("div",ne,[d(s(K),{class:"h-4 w-4 stroke-1.5 mr-2 text-gray-600"}),r("span",null,l(t.batch.timezone),1)])):u("",!0)]),(b=t.batch.instructors)!=null&&b.length?(a(),c("div",ie,[r("div",{class:$(["h-6 mr-1",{"avatar-group overlap":t.batch.instructors.length>1}])},[(a(!0),c(D,null,P(t.batch.instructors,y=>(a(),f(Z,{user:y},null,8,["user"]))),256))],2),d(Y,{instructors:t.batch.instructors},null,8,["instructors"])])):u("",!0)])}}},ue={class:""},he={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-3 py-2.5 sm:px-5"},me={class:"flex space-x-2"},be={class:"w-40"},fe={key:0,class:"pb-5"},ge={key:0,class:"p-5 text-base text-gray-700"},_e={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 m-5"},ye={key:1,class:"grid flex-1 place-items-center text-xl font-medium text-gray-500"},ve={class:"flex flex-col items-center justify-center mt-4"},Be={__name:"Batches",setup(t){var B;const n=U("$user"),i=V(null);F(()=>{let e=new URLSearchParams(location.search);e.has("category")&&(i.value=e.get("category"))});const b=M({doctype:"LMS Batch",url:"lms.lms.utils.get_batches",cache:["batches",(B=n==null?void 0:n.data)==null?void 0:B.email],auto:!0}),y=R({url:"lms.lms.api.get_categories",makeParams(){return{doctype:"LMS Batch",filters:{published:1}}},cache:["batchCategories"],auto:!0,transform(e){e.unshift({label:"",value:null})}}),w=V(0);let p;const j=x(()=>{var e;return p=[],v("Upcoming"),(e=n.data)!=null&&e.is_moderator&&(v("Archived"),v("Private")),n.data&&v("Enrolled"),p}),z=e=>i.value&&i.value!=""?b.data[e].filter(h=>h.category==i.value):b.data[e],v=e=>{let h=z(e.toLowerCase().split(" ").join("_"));p.push({label:e,batches:x(()=>h),count:x(()=>h.length)})};A(()=>i.value,()=>{let e=new URLSearchParams(location.search);i.value?e.set("category",i.value):e.delete("category"),history.pushState(null,"",`${location.pathname}?${e.toString()}`)});const T=x(()=>({title:"Batches",description:"All batches divided by categories"}));return Q(T),(e,h)=>{var L,S;const C=G("router-link");return a(),c("div",ue,[r("header",he,[d(s(q),{class:"h-7",items:[{label:e.__("Batches"),route:{name:"Batches"}}]},null,8,["items"]),r("div",me,[r("div",be,[(L=s(y).data)!=null&&L.length?(a(),f(s(E),{key:0,modelValue:i.value,"onUpdate:modelValue":h[0]||(h[0]=o=>i.value=o),options:s(y).data,placeholder:e.__("Filter")},null,8,["modelValue","options","placeholder"])):u("",!0)]),(S=s(n).data)!=null&&S.is_moderator?(a(),f(C,{key:0,to:{name:"BatchForm",params:{batchName:"new"}}},{default:m(()=>[d(s(I),{variant:"solid"},{prefix:m(()=>[d(s(W),{class:"h-4 w-4 stroke-1.5"})]),default:m(()=>[_(" "+l(e.__("New Batch")),1)]),_:1})]),_:1})):u("",!0)])]),s(b).data?(a(),c("div",fe,[s(b).data.length==0&&s(b).list.loading?(a(),c("div",ge,l(e.__("Loading Batches...")),1)):u("",!0),d(s(H),{modelValue:w.value,"onUpdate:modelValue":h[1]||(h[1]=o=>w.value=o),tabs:j.value,tablistClass:"overflow-x-visible flex-wrap !gap-3 md:flex-nowrap"},{tab:m(({tab:o,selected:g})=>[r("div",null,[r("button",{class:$(["group -mb-px flex items-center gap-2 border-b border-transparent py-2.5 text-base text-gray-600 duration-300 ease-in-out hover:border-gray-400 hover:text-gray-900",{"text-gray-900":g}])},[o.icon?(a(),f(O(o.icon),{key:0,class:"h-5"})):u("",!0),_(" "+l(e.__(o.label))+" ",1),d(s(k),{class:$(g?"text-gray-800 border border-gray-800":"border border-gray-500"),variant:"subtle",theme:"gray",size:"sm"},{default:m(()=>[_(l(o.count),1)]),_:2},1032,["class"])],2)])]),default:m(({tab:o})=>[o.batches&&o.batches.value.length?(a(),c("div",_e,[(a(!0),c(D,null,P(o.batches.value,g=>(a(),f(C,{to:{name:"BatchDetail",params:{batchName:g.name}}},{default:m(()=>[d(de,{batch:g},null,8,["batch"])]),_:2},1032,["to"]))),256))])):(a(),c("div",ye,[r("div",ve,[r("div",null,l(e.__("No {0} batches found").format(o.label.toLowerCase())),1)])]))]),_:1},8,["modelValue","tabs"])])):u("",!0)])}}};export{Be as default};
//# sourceMappingURL=Batches-CNkRvFXx.js.map
